---
title: R
format:
  html:
    toc: true
---



## Learning R

### Contributors

-   Several colleagues/PhD students (2021-2023)
-   Ler Vin See (Jan 2024)
-   Sarah Lim (July 2024)

## Steps to follow

## Step 1: Installing RStudio

Install `RStudio` and `R` (and know the difference between them)  
- You can install both using [this link](https://posit.co/download/rstudio-desktop/) - `R` is both a software and programming language\
- `Rstudio` provides a (nice) environment to run `R`  
- This website provides a nice [explanation of key concepts](https://okanbulut.github.io/edpy507/learning-r.html)

## Step 2: Installing R Packages

In `Rstudio`, perform these 2 basic chores:   
- Install `R` packages[^1]  
i. `readxl`   
ii. `tidyverse`[^2]  
iii. `here`   
iv. `janitor`  
v. `rms`  

[^1]: Packages that are downloaded contain many functions that can be used to accomplishes some tasks. Each `R` function is a set of statements organized together to perform a specific task.

[^2]: `tidyverse` is different from the other packages, as it is a package that contains other packages. You can view the packages contained in `tidyverse` using [this link](https://www.tidyverse.org/). Note, however, that it is still crucial to learn base `R`!

#### Package, Function, Code: An Analogy

::: panel-tabset
## Package

A `package` with its many `functions` can be seen as a book containing many pages. Just like how every page of a book tells a story, every R `function` in a `package` is based on accomplishing a task (e.g. tidying workspace or reading excel sheets)

## Function

A `function` can be seen as a page contained within a book (the `package`). This is the most important part of the 3 components mentioned here, as these `functions` are the ones you'll be using when coding in `RStudio`. `Functions` will perform tasks for you so you don't have to code something from scratch.

::: callout-note
To access the available functions, you first have to “activate” the `package` that the function is found in. You can do this by using the `library()` function (add the name of the package between the brackets). To learn about the functions available in a package, click on the “packages” button at the bottom right panel, and it will display a list of functions as well as what they will do
:::

## Codes

Codes can be seen as the letters found on a page (`function`). Each page has a different number of letters, which is similar to how some `functions` are more complicated than others, and as such contain more lines of code.
:::

::: callout-note
When you try downloading R packages, `RStudio` may prompt you to install `Rtools` . You can do so on this [website](https://cran.rstudio.com/bin/windows/Rtools/)
:::

::: callout-tip
## Tip

To learn about the functions available in a `package`, click on the “packages” button at the bottom right panel, and it will display a list of functions as well as what they will do
:::

### Step 2.1: How to use packages

-   Many functions that can aid in data analysis are found within packages that you have downloaded earlier. To access these functions, you first have to load or “activate” the package that the function is found in. You can do this by using `library(package you want to load)`

### Step 2.2: Moving Rstudio Panels

-   Move console pane to the [right](https://okanbulut.github.io/edpy507/learning-r.html) 
-   Do this by clicking on the icon that looks like for squares on the left of “Addins”, where you will select the option “Console on right”   

![](hpics/panel_screenshot.PNG)

## Step 3: Creating a Project Folder

![](hpics/r.qmd pic5.jpg){width="35%"}

[Why it is important](https://alexd106.github.io/intro2R/project_setup.html) 

-   Having clear project organisation simplifies understanding of information for both you and your collaborators  
-   A consistent and logical structure allows you to access and work with codes and data conveniently, avoiding situations where you have "missing" codes or data files  
-   A well organised project reduces the risk of introducing bugs or errors into your workflow and even if they do occur, it is easier to track down the errors and deal with them efficiently

1.  Open R studio
2.  Click File- New Project- New Directory- New Project- enter Project name- Create folder in preferred location (e.g. in Desktop)- Create Project

![](hpics/r.qmd pic1.png){width="50%"}

3.  Click the white icon with green + sign on the top left corner to create new R script and save it

![](hpics/r.qmd pic2.jpg){width="40%"}

4.  Add data files into the project file as necessary
5.  As desired, open the project folder ① and click on the R project file ② . Should you have followed the above steps, you will be able to access the R script ③ and relevant data files ④ from within the project folder to work on. This is highly recommended for your convenience.

![](hpics/r.qmd pic3.png){width="60%"}

Alternatively, you can watch [this](https://www.youtube.com/watch?v=WyrJmJWgPiU) video for more detailed instructions

Tips:

-   Use `here` package after installing it in Step 2. It helps you locate your files if you start working in R without first opening a project folder, learn more [here](https://github.com/jennybc/here_here)

```{r}
#| echo: TRUE
#| eval: FALSE
library(here)
here("Wombat", "WBS data files")
```

## Step 4: fastR lesson

-   Write and run some codes on the `source` panel[^3]

[^3]: Gotcha! User needs to understand that nothing gets saved after each session and all codes in R script need to be re-run during each session.

<!-- -->

-   Go through lessons $1$ to $8$ of [fastR](https://github.com/matloff/fasteR)

## Step 5: Learning important verbs

-   Try searching up verbs in the `tidyverse` package
-   Based on the built-in `mtcars`, learn how to use the pipe (%\>%) operator + the following `dplyr`[^4] verbs: `filter`, `select`, `arrange`, `count`, `rename`, `case_when`, `mutate`
-   When searching for info on how to perform some actions using R, try adding the package name in the prompt, or use ?(package name) to see the functions available in a specific package
-   [Basic tutorial](https://craig.rbind.io/post/2019-12-30-asgr-2-1-data-transformation-part-1/)
-   [Data analysis intro vid](https://www.youtube.com/watch?v=yZ0bV2Afkjc)
-   [Andrew Heiss website](https://evalsp23.classes.andrewheiss.com/resource/style.html)\
-   [Peter D.R. Higgins e-book](https://bookdown.org/pdr_higgins/rmrwr/a-tasting-menu-of-r.html)
-   `recode()` and `relevel` factor levels using the `forcats::fct_relevel()`

[^4]: `dplyr` is a powerful R package for data manipulation. It provides a consistent set of verbs that help you tackle common data manipulation tasks. It is a `package` contained within `tidyverse`. You can get more details from [this link](https://dplyr.tidyverse.org/)

## Step 6: Read excel files

-   Read an external file: use `here()` package to manage file-path
-   Create a `Rstudio` project
-   Read a file using `readxl` + `here()`

### Step 6.1: Alternative method to read excel files

If you plan to use Rstudio for data analysis and plan to import a data table, create a folder where you can store all the files you’ll be using to analyze the files

-   Add the excel file you want to analyze in this folder
-   On `Rstudio`, create a new project (refer to step 3) and shift this file into the same file with the excel sheet
-   After this, using the `list.files()`[^5] function should bring up the other files in the same folder of this project, including the excel sheet
-   You can isolate the file you want to open by using `list.files()[Assigned number of target file]`

[^5]: `list.files()` will only detect files that are located in the same folder as the project you are working on. Make sure to add everything you need(e.g. excel spreadsheets) in the same folder

::: callout-tip
## Tip

Creating a project is useful, as it allows you to access and manage your own files more conveniently using `list.files()` (more on this later)
:::

```{r}
#| echo: TRUE
#| eval: FALSE
# list.files() in action!
list.files()

[1] "panel_screenshot.png" "R.html"               "R.qmd"               
[4] "R.rmarkdown"          "R_files"  
     
```

## Step 7: Data Cleaning

-   Go through the [Janitor vignette](https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html)

## Step 8: Additional lessons and more verbs

-   Learn more [variable selection operators](https://tidyselect.r-lib.org/reference/starts_with.html) : `starts_with()`, `ends_with()`, `contains()`, `matches()`\
-   Learn more `dplyr` verbs and base R functions, [this](https://dplyr.tidyverse.org/) is a cheat sheet for you
-   Go through lessons $9$ to $13$ of [fastR](https://github.com/matloff/fasteR)[^6]

[^6]: How does `tapply()` compare with `group_by` + `summarise` ?

## Step 9: Tidy your R script

-   Ctrl + Shift + R to create sections between codes
-   Alt + L to fold (compress) a highlighted chunk of code
-   Use # for commenting/ labeling your codes as R does not read it 

## Resources to learn R

[Harrell's R workflow](https://hbiostat.org/rflow/)

[R Weekly newsletter](https://rweekly.org/): e-mail is sent every Monday and is full of helpful tutorials about how to do stuff with R.

[#rstats](https://twitter.com/search?q=%23rstats): For twitter users

[StackOverflow](https://stackoverflow.com/): Q&A site with answers to all sorts of programming questions

[RStudio Community](https://community.rstudio.com/) a forum for Rstudio users

[**R for Data Science**](https://r4ds.had.co.nz/): A free online book for learning the basics of R and the tidyverse.

[**R and RStudio cheat sheets**](https://www.rstudio.com/resources/cheatsheets/): A large collection of simple cheat sheets for RStudio, **ggplot2**, and other R-related things.

[**CSE 631: Principles & Practice of Data Visualization**](http://cslu.ohsu.edu/~bedricks/courses/cs631/):

[**Data Cleaning**](https://www.geeksforgeeks.org/data-cleaning-in-r/): A few simple examples that go through the basics of cleaning data
